time_horizon:
  start: 2025
  end: 2100
  step: 5  # Emission reporting grid; FaIR extends beyond this using constant terminal deltas when damage_duration_years demands longer horizons.

calc_emissions:
  countries:
    directory: data/calc_emissions/countries
    pattern: config_{name}.yaml
    aggregate_output_directory: resources/All_countries
    aggregate_results_directory: results/emissions/All_countries
    # Scenarios here should list mix scenario NAMES (the top-level mix keys
    # from each country config). Use the three standard mixes we now expect:
    scenarios:
      - Reference
      - WEM
      - WAM
    #  - custom_example

climate_module:
  output_directory: results/climate  # Directory for climate results (relative to repository root).
  resource_directory: resources/climate  # Copy of temperature outputs used as shared resources across modules.
  sample_years_option: default  # 'default' (5-year steps to 2050, then 10-year) or 'full'.
  emission_timeseries_directory: resources/All_countries  # Folder containing <scenario>/co2.csv (Mt CO₂/yr; output from calc_emissions aggregation).

  parameters:
    # Time grid inherits from time_horizon and stretches to cover the SCC damage window.
    # Emission adjustments are held fixed at their terminal value when extrapolating past the reporting horizon.
    climate_setup: ar6  # Options include 'ar6' (default three-layer) and 'two_box'.
    deep_ocean_efficacy: 1.28  # Plausible range 0.5–1.5 (higher slows deep-ocean uptake).
    forcing_4co2: 7.4  # W/m² for 4×CO₂; AR6 central estimate ≈7.2–7.4.
    equilibrium_climate_sensitivity: 3.0  # °C per CO₂ doubling; likely range 2.0–5.0.

  climate_scenarios:
    run: all  # FaIR pathways to evaluate (use 'all' or list of SSP IDs).
    definitions:
      - id: ssp119  # Strong mitigation SSP (aggressive climate action)
        label: ssp119
        adjustment_specie: CO2 FFI  # Emission adjustments are specified in Mt CO₂/yr.
      - id: ssp245  # Middle-of-the-road SSP (reference case)
        label: ssp245
        adjustment_specie: CO2 FFI
      - id: ssp370  # Higher-emission SSP (limited mitigation)
        label: ssp370
        adjustment_specie: CO2 FFI

  emission_scenarios:
    run: all  # Load from <scenario>_emission_difference.csv (Mt CO₂/yr deltas; use 'all' or list of names).

pattern_scaling:
  output_directory: results/climate_scaled
  scaling_factors_file: data/cmip6_pattern_scaling_by_country_mean.csv  # Columns: name, iso3, continent, scenario, patterns.* (weighting basis)
  scaling_weighting: area  # Options: gdp.2000, gdp.2100, pop.2000, pop.2100, area (default)
  countries: # List of ISO3 codes
    - ALB
    - BIH
    - MKD
    - KOS # Kosovo, unofficially assigned ISO3 code
    - SRB
    - MNE

air_pollution:
  output_directory: results/air_pollution
  concentration_measure: median  # Default concentration statistic to use when available.
  concentration_fallback_order:  # Ordered fallback when the preferred measure is missing.
    - median
    - mean
    - min
    - max
  country_weights: equal  # Use 'equal' for uniform averaging or provide {Country: weight}.
  scenarios: all  # 'all' or list of emission scenario names to process.
  pollutants:
    pm25:
      stats_file: data/air_pollution/PM25_country_stats.csv
      relative_risk: 1.08  # RR for a 10 µg/m³ change (log-linear model).
      reference_delta: 10.0  # µg/m³ associated with the relative_risk value.
      # country_weights:  # Optional override (values will be normalised).
      #   Bosnia and Herzegovenia: 2.0
      #   Kosovo: 1.0
    nox:
      stats_file: data/air_pollution/NOx_country_stats.csv
      relative_risk: 1.03
      reference_delta: 10.0
  baseline_deaths:
    total: 19000  # Total deaths attributed to air pollution over the specified years.
    span:
      start: 2018
      end: 2020
    
economic_module:
  output_directory: results/economic  # Folder receiving SCC summary, detail, and per-year CSVs.
  gdp_series: null  # Optional override CSV with columns: year, gdp_trillion_usd [, population_million].
  gdp_population_directory: data/GDP_and_Population_data  # Prefers long CSVs (SSP_gdp_long_2020ppp.csv, SSP_population_long.csv); falls back to Excel.
  run:
    method: pulse          # 'kernel' (fast IRF approximation;TODO get timeseries plot for this as well) or 'pulse' (FaIR pulse runs)
    kernel:
      horizon: null           # Optional integer L; null uses full length
      regularization_alpha: 1.0e-6  # Ridge α for kernel inversion
      nonnegativity: false    # Clip kernel to g(ℓ) ≥ 0
      smoothing_lambda: 0.0   # Roughness penalty weight (first-difference)
      allocation:
        linearized_damage: false  # Use ∂D/∂T × ΔTτ instead of full damage diff
    pulse:
      pulse_size_tco2: 1000000.0  # 1 MtCO₂ pulse size per year when using pulse valuation
  data_sources:
    emission_root: resources/All_countries  # Root directory containing <scenario>/co2.csv produced by calc_emissions aggregation.
    temperature_root: resources/climate  # Directory containing <scenario>_<climate>.csv exported by the climate module.
    climate_scenarios:
      - ssp119
      - ssp245
      - ssp370
  reference_scenario: baseline  # Baseline label for damage differences.
  evaluation_scenarios:  # Additional scenarios evaluated by default (match calc_emissions scenario names).
    - scenario_1_lower_bound
    - scenario_1_upper_bound
  base_year: 2025  # Present-value reference year for discounting (must exist in GDP/temperature grids).
  damage_duration_years: 450  # Duration (years from start) for SCC damages; must exceed time_horizon span (FaIR runs to start + duration - 1 with constant emission tails).
  aggregation: per_year  # 'average' (USD/tCO₂) or 'per_year' (time series).
  aggregation_horizon:
    start: 2025  # Averaging window start year (required when aggregation == 'average').
    end: 2050  # Averaging window end year (inclusive).
  emission_column: delta  # Column name in emission CSVs (FaIR export uses 'delta' for Mt CO₂/yr deltas).
  emission_to_tonnes: 1000000.0  # Unit converter for emission_column (1e6 converts Mt → tonnes CO₂).
  damage_function:  # DICE-style quadratic damages configuration.
    delta1: 0.0
    delta2: 0.00236
    use_threshold: false  # true to amplify damages past the threshold temperature.
    threshold_temperature: 3.0  # °C at which threshold amplification starts.
    threshold_scale: 0.2  # Multiplier applied to exceedance when threshold is enabled.
    threshold_power: 2.0  # Power applied to the exceedance term.
    use_saturation: false  # true to use a smooth rational saturation curve.
    max_fraction: 0.99  # Maximum GDP loss fraction (also used for final clamp).
    saturation_mode: rational  # 'rational' or 'clamp' when saturation is enabled.
    use_catastrophic: false  # true to add catastrophe risk beyond catastrophic_temperature.
    catastrophic_temperature: 5.0  # °C at which catastrophe risk begins.
    disaster_fraction: 0.75  # Fractional GDP loss when catastrophe occurs.
    disaster_gamma: 1.0  # Steepness of probabilistic catastrophe response.
    disaster_mode: prob  # 'prob' (exponential) or 'step' catastrophe behaviour.
  methods:  # Discounting configurations ('all' runs both methods).
    run: ramsey_discount
    constant_discount:  # Fixed annual discount rate r; SCC uses 1/(1+r)^{t-base_year}.
      discount_rate: 0.03
    ramsey_discount:  # Ramsey: rho = pure time preference, eta = utility elasticity.
      rho: 0.005
      eta: 1.5

results:
  run_directory: null  # Optional subfolder: set to e.g. 'run_A' to nest results/* under results/run_A/.
  summary:
    years:  # Key reporting years for summary outputs (includes SCC, damages, emissions, temperature, mortality).
      - 2030
      - 2050
    output_directory: results/summary  # Where summary.txt and plots are written.
    include_plots: true  # Disable if running in environments without matplotlib.
    plot_format: png  # File format for bar charts (png, svg, pdf, …).
